{"ast":null,"code":"import axios from 'axios';\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\naxios.defaults.baseURL = 'https://taskpro-backend-uiwy.onrender.com';\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  }\n};\nexport const register = createAsyncThunk('auth/register', async (credentials, thunkAPI) => {\n  try {\n    const {\n      data\n    } = await axios.post('/api/users/register', credentials);\n    token.set(data.user.token);\n    return data;\n  } catch (error) {\n    return thunkAPI.rejectWithValue(error.message);\n  }\n});\nexport const logIn = createAsyncThunk('auth/login', async credentials => {\n  try {\n    const {\n      data\n    } = await axios.post('/api/users/login', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    toast.error('Error: \"The email address or password is incorrect. Please retry...\"');\n  }\n});\nexport const logOut = createAsyncThunk('auth/logout', async () => {\n  try {\n    thunkAPI.dispatch({\n      type: 'auth/clearState'\n    });\n    await axios.post('/api/users/logout');\n  } catch (error) {}\n});\nexport const refreshUser = createAsyncThunk('auth/refresh', async (_, thunkAPI) => {\n  const state = thunkAPI.getState();\n  const persistedToken = state.auth.token;\n  if (!persistedToken) {\n    return thunkAPI.rejectWithValue('Oops');\n  }\n  token.set(persistedToken);\n  try {\n    const {\n      data\n    } = await axios.get('/api/users/current');\n    return data;\n  } catch (error) {\n    return thunkAPI.rejectWithValue(error.message);\n  }\n});\nexport const editProfile = createAsyncThunk('auth/editProfile', async _ref => {\n  let {\n    formData,\n    thunkAPI,\n    token\n  } = _ref;\n  try {\n    const resp = await axios.patch('api/users', formData, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    return resp.data.user;\n  } catch (e) {\n    return thunkAPI.rejectWithValue(e.message);\n  }\n});","map":{"version":3,"names":["axios","createAsyncThunk","toast","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","thunkAPI","data","post","user","error","rejectWithValue","message","logIn","logOut","dispatch","type","refreshUser","_","state","getState","persistedToken","auth","get","editProfile","_ref","formData","resp","patch","e"],"sources":["/Users/vlasvin/Documents/GitHub/TaskPro-FrontEnd-Team5/src/store/auth/authOperations.js"],"sourcesContent":["import axios from 'axios';\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\naxios.defaults.baseURL = 'https://taskpro-backend-uiwy.onrender.com';\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  },\n};\n\nexport const register = createAsyncThunk(\n  'auth/register',\n  async (credentials, thunkAPI) => {\n    try {\n      const { data } = await axios.post('/api/users/register', credentials);\n      token.set(data.user.token);\n      return data;\n    } catch (error) {\n      return thunkAPI.rejectWithValue(error.message);\n    }\n  }\n);\n\nexport const logIn = createAsyncThunk('auth/login', async credentials => {\n  try {\n    const { data } = await axios.post('/api/users/login', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    toast.error(\n      'Error: \"The email address or password is incorrect. Please retry...\"'\n    );\n  }\n});\n\nexport const logOut = createAsyncThunk('auth/logout', async () => {\n  try {\n    thunkAPI.dispatch({ type: 'auth/clearState' });\n    await axios.post('/api/users/logout');\n  } catch (error) {}\n});\n\nexport const refreshUser = createAsyncThunk(\n  'auth/refresh',\n  async (_, thunkAPI) => {\n    const state = thunkAPI.getState();\n    const persistedToken = state.auth.token;\n    if (!persistedToken) {\n      return thunkAPI.rejectWithValue('Oops');\n    }\n    token.set(persistedToken);\n    try {\n      const { data } = await axios.get('/api/users/current');\n      return data;\n    } catch (error) {\n      return thunkAPI.rejectWithValue(error.message);\n    }\n  }\n);\n\nexport const editProfile = createAsyncThunk(\n  'auth/editProfile',\n  async ({ formData, thunkAPI, token }) => {\n    try {\n      const resp = await axios.patch('api/users', formData, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n\n      return resp.data.user;\n    } catch (e) {\n      return thunkAPI.rejectWithValue(e.message);\n    }\n  }\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}